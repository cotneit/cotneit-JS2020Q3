(()=>{"use strict";function e(e){return e<10?"0"+e:""+e}class t{constructor(){this.intervals=[]}update(){this.intervals[this.intervals.length-1]+=1e3,this.updateElement()}start(){this.active=!0,this.intervals.push(0),this.interval=setInterval((()=>{this.update()}),1e3)}pause(){this.active&&(clearInterval(this.interval),this.active=!1)}reset(){this.pause(),this.intervals.length=0,this.updateElement()}getTime(){const t=e(this.getHours()),s=e(this.getMinutes()),i=e(this.getSeconds());return"00"===t?`${s}:${i}`:`${t}:${s}:${i}`}getMilliseconds(){return this.intervals.reduce(((e,t)=>e+t),0)%1e3}getSeconds(){const e=this.intervals.reduce(((e,t)=>e+t),0);return Math.floor(e%6e4/1e3)}getMinutes(){const e=this.intervals.reduce(((e,t)=>e+t),0);return Math.floor(e%36e5/6e4)}getHours(){const e=this.intervals.reduce(((e,t)=>e+t),0);return Math.floor(e/36e5)}createElement(e){return this.DOMElement=document.createElement(e),this.updateElement(),this.DOMElement}updateElement(){this.DOMElement&&(this.DOMElement.textContent=this.getTime())}}document.documentElement.classList.add("page"),document.body.classList.add("page__inner");const s=(new class{constructor(){this.timer=new t,this.state={size:4,tiles:[],moves:0,isSolved:!1},this.stateProxy=new Proxy(this.state,{set:(e,t,s,i)=>("moves"===t&&(this.elements.moveCounter.textContent="Moves: "+s),"size"===t?(Reflect.set(e,t,s,i),this.startNewGame(),!0):Reflect.set(e,t,s,i))}),this.eventListeners={tileOnclick:e=>{const{tiles:t,size:s}=this.state,i=t.map((e=>e.element)).indexOf(e.target);if(!this.state.isSolved){switch(this.timer.active||this.timer.start(),!0){case t[i-1]&&-1===t[i-1].id&&i%s!=0:[t[i],t[i-1]]=[t[i-1],t[i]],this.stateProxy.moves+=1;break;case t[i+1]&&-1===t[i+1].id&&i%s!=s-1:[t[i],t[i+1]]=[t[i+1],t[i]],this.stateProxy.moves+=1;break;case t[i-s]&&-1===t[i-s].id:[t[i],t[i-s]]=[t[i-s],t[i]],this.stateProxy.moves+=1;break;case t[i+s]&&-1===t[i+s].id:[t[i],t[i+s]]=[t[i+s],t[i]],this.stateProxy.moves+=1}this.renderTiles(),this.checkState()}}}}init(){return this.createElements(),this.generateTiles(),this.startNewGame(),this.elements.container}startNewGame(){this.state.isSolved=!1,this.stateProxy.moves=0,this.timer.reset(),this.shuffleTiles(),this.renderTiles(),this.elements.board.style.gridTemplateColumns=`repeat(${this.state.size}, 1fr)`}generateTiles(){const e=this.state.size**2,t=[],s={id:-1,element:document.createElement("div")};for(let s=0;s<e-1;s+=1){const e={};e.id=s+1,e.element=document.createElement("div"),e.element.classList.add("gem-puzzle__tile"),e.element.textContent=e.id,t.push(e),e.element.addEventListener("click",this.eventListeners.tileOnclick)}t.push(s),this.state.tiles=t}renderTiles(){const{tiles:e}=this.state;e.forEach((e=>{this.elements.board.append(e.element)}))}checkState(){const e=this.state.tiles.map((e=>e.id));for(let t=0;t+2<e.length;t+=1)if(e[t+1]!==e[t]+1)return;this.timer.pause(),this.state.isSolved=!0,setTimeout((()=>{alert(`You solved the puzzle in ${this.timer.getTime()} and made ${this.state.moves} moves.\nSorry for the alert, work in progress.`)}),0)}shuffleTiles(){const e=this.state.size**2,{tiles:t}=this.state;for(let s=0;s<e;s+=1){const i=Math.floor(Math.random()*e);[t[s],t[i]]=[t[i],t[s]]}this.isSolvable()||this.shuffleTiles()}isSolvable(){const{tiles:e,size:t}=this.state,s=e.map((e=>e.id)),i=s.indexOf(-1),n=Math.ceil((i+1)/t);let a=0;for(let e=0;e<s.length;e+=1)if(-1!==s[e])for(let t=e;t<s.length;t+=1)s[e]>s[t]&&-1!==s[t]&&(a+=1);if(t%2==1&&a%2==0)return!0;if(t%2==0){if(n%2==1&&a%2==1)return!0;if(n%2==0&&a%2==0)return!0}return!1}createElements(){const e=document.createElement("div"),t=document.createElement("div"),s=document.createElement("div"),i=document.createElement("span"),n=document.createElement("span"),a=document.createElement("button");e.classList.add("gem-puzzle"),t.classList.add("gem-puzzle__status-bar"),s.classList.add("gem-puzzle__board"),s.style.gridTemplateColumns=`repeat(${this.state.size}, 1fr)`,i.textContent="Timer: ",i.append(this.timer.createElement("time")),n.textContent="Moves: 0",a.type="button",a.classList.add("gem-puzzle__button"),a.textContent="New game",a.addEventListener("click",(()=>{this.startNewGame()})),t.append(i,a,n),e.append(t,s),this.elements={container:e,statusBar:t,board:s,timer:i,moveCounter:n}}}).init();document.body.append(s)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9nZW0tcHV6emxlLy4vc3JjL2dlbS1wdXp6bGUvdXRpbHMuanMiLCJ3ZWJwYWNrOi8vZ2VtLXB1enpsZS8uL3NyYy9nZW0tcHV6emxlL1RpbWVyLmpzIiwid2VicGFjazovL2dlbS1wdXp6bGUvLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vZ2VtLXB1enpsZS8uL3NyYy9nZW0tcHV6emxlL2dlbS1wdXp6bGUuanMiXSwibmFtZXMiOlsiYXBwZW5kWmVybyIsIm51bSIsIlRpbWVyIiwidGhpcyIsImludGVydmFscyIsImxlbmd0aCIsInVwZGF0ZUVsZW1lbnQiLCJhY3RpdmUiLCJwdXNoIiwiaW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsInVwZGF0ZSIsImNsZWFySW50ZXJ2YWwiLCJwYXVzZSIsImhvdXJzIiwiZ2V0SG91cnMiLCJtaW51dGVzIiwiZ2V0TWludXRlcyIsInNlY29uZHMiLCJnZXRTZWNvbmRzIiwicmVkdWNlIiwiYWNjIiwiY3VyciIsInRpbWVQYXNzZWQiLCJNYXRoIiwiZmxvb3IiLCJ0YWciLCJET01FbGVtZW50IiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwidGV4dENvbnRlbnQiLCJnZXRUaW1lIiwiZG9jdW1lbnRFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwiYm9keSIsImdlbVB1enpsZUVsZW1lbnQiLCJ0aW1lciIsInN0YXRlIiwic2l6ZSIsInRpbGVzIiwibW92ZXMiLCJpc1NvbHZlZCIsInN0YXRlUHJveHkiLCJQcm94eSIsInNldCIsInRhcmdldCIsInByb3AiLCJ2YWx1ZSIsInJlY2VpdmVyIiwiZWxlbWVudHMiLCJtb3ZlQ291bnRlciIsIlJlZmxlY3QiLCJzdGFydE5ld0dhbWUiLCJldmVudExpc3RlbmVycyIsInRpbGVPbmNsaWNrIiwiZXZlbnQiLCJpbmRleCIsIm1hcCIsInRpbGUiLCJlbGVtZW50IiwiaW5kZXhPZiIsInN0YXJ0IiwiaWQiLCJyZW5kZXJUaWxlcyIsImNoZWNrU3RhdGUiLCJjcmVhdGVFbGVtZW50cyIsImdlbmVyYXRlVGlsZXMiLCJjb250YWluZXIiLCJyZXNldCIsInNodWZmbGVUaWxlcyIsImJvYXJkIiwic3R5bGUiLCJncmlkVGVtcGxhdGVDb2x1bW5zIiwidGlsZUFtb3VudCIsImVtcHR5VGlsZSIsImkiLCJhZGRFdmVudExpc3RlbmVyIiwiZm9yRWFjaCIsImFwcGVuZCIsInRpbGVJZHMiLCJzZXRUaW1lb3V0IiwiYWxlcnQiLCJyYW5kb21UaWxlIiwicmFuZG9tIiwiaXNTb2x2YWJsZSIsImVtcHR5VGlsZUluZGV4IiwiZW1wdHlUaWxlUm93IiwiY2VpbCIsImludmVyc2lvbnMiLCJqIiwic3RhdHVzQmFyIiwibmV3R2FtZUJ0biIsInR5cGUiLCJpbml0Il0sIm1hcHBpbmdzIjoibUJBQ0EsU0FBU0EsRUFBV0MsR0FDbEIsT0FBT0EsRUFBTSxHQUFLLElBQUlBLEVBQVEsR0FBR0EsRUNBcEIsTUFBTUMsRUFDbkIsY0FDRUMsS0FBS0MsVUFBWSxHQUduQixTQUNFRCxLQUFLQyxVQUFVRCxLQUFLQyxVQUFVQyxPQUFTLElBQU0sSUFDN0NGLEtBQUtHLGdCQUdQLFFBQ0VILEtBQUtJLFFBQVMsRUFDZEosS0FBS0MsVUFBVUksS0FBSyxHQUNwQkwsS0FBS00sU0FBV0MsYUFBWSxLQUMxQlAsS0FBS1EsV0FDSixLQUdMLFFBQ01SLEtBQUtJLFNBQ1BLLGNBQWNULEtBQUtNLFVBQ25CTixLQUFLSSxRQUFTLEdBSWxCLFFBQ0VKLEtBQUtVLFFBQ0xWLEtBQUtDLFVBQVVDLE9BQVMsRUFDeEJGLEtBQUtHLGdCQUdQLFVBQ0UsTUFBTVEsRUFBUWQsRUFBV0csS0FBS1ksWUFDeEJDLEVBQVVoQixFQUFXRyxLQUFLYyxjQUMxQkMsRUFBVWxCLEVBQVdHLEtBQUtnQixjQUVoQyxNQUFjLE9BQVZMLEVBQ0ssR0FBR0UsS0FBV0UsSUFHaEIsR0FBR0osS0FBU0UsS0FBV0UsSUFHaEMsa0JBR0UsT0FGbUJmLEtBQUtDLFVBQVVnQixRQUFPLENBQUNDLEVBQUtDLElBQVVELEVBQU1DLEdB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LEdBQUtFLEVBQWEsR0FBTSxFQUMvQyxPQUFPLEVBSVgsT0FBTyxFQUdULGlCQUNFLE1BQU1yQixFQUFZeEMsU0FBU0MsY0FBYyxPQUNuQzhELEVBQVkvRCxTQUFTQyxjQUFjLE9BQ25DMEMsRUFBUTNDLFNBQVNDLGNBQWMsT0FDL0JRLEVBQVFULFNBQVNDLGNBQWMsUUFDL0JzQixFQUFjdkIsU0FBU0MsY0FBYyxRQUNyQytELEVBQWFoRSxTQUFTQyxjQUFjLFVBRzFDdUMsRUFBVW5DLFVBQVVDLElBQUksY0FDeEJ5RCxFQUFVMUQsVUFBVUMsSUFBSSwwQkFDeEJxQyxFQUFNdEMsVUFBVUMsSUFBSSxxQkFDcEJxQyxFQUFNQyxNQUFNQyxvQkFBc0IsVUFBVXRFLEtBQUttQyxNQUFNQyxhQUd2REYsRUFBTVAsWUFBYyxVQUNwQk8sRUFBTTBDLE9BQU81RSxLQUFLa0MsTUFBTVIsY0FBYyxTQUd0Q3NCLEVBQVlyQixZQUFjLFdBRzFCOEQsRUFBV0MsS0FBTyxTQUNsQkQsRUFBVzNELFVBQVVDLElBQUksc0JBQ3pCMEQsRUFBVzlELFlBQWMsV0FDekI4RCxFQUFXZixpQkFBaUIsU0FBUyxLQUNuQzFFLEtBQUtrRCxrQkFHUHNDLEVBQVVaLE9BQU8xQyxFQUFPdUQsRUFBWXpDLEdBQ3BDaUIsRUFBVVcsT0FBT1ksRUFBV3BCLEdBRTVCcEUsS0FBSytDLFNBQVcsQ0FDZGtCLFlBQ0F1QixZQUNBcEIsUUFDQWxDLFFBQ0FjLGtCRHBPNkIyQyxPQUNuQ2xFLFNBQVNPLEtBQUs0QyxPQUFPM0MsSSIsImZpbGUiOiJhcHAuYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgaW1wb3J0L3ByZWZlci1kZWZhdWx0LWV4cG9ydCAqL1xuZnVuY3Rpb24gYXBwZW5kWmVybyhudW0pIHtcbiAgcmV0dXJuIG51bSA8IDEwID8gYDAke251bX1gIDogYCR7bnVtfWA7XG59XG5cbmV4cG9ydCB7XG4gIGFwcGVuZFplcm8sXG59O1xuIiwiaW1wb3J0IHsgYXBwZW5kWmVybyB9IGZyb20gJy4vdXRpbHMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUaW1lciB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuaW50ZXJ2YWxzID0gW107XG4gIH1cblxuICB1cGRhdGUoKSB7XG4gICAgdGhpcy5pbnRlcnZhbHNbdGhpcy5pbnRlcnZhbHMubGVuZ3RoIC0gMV0gKz0gMTAwMDtcbiAgICB0aGlzLnVwZGF0ZUVsZW1lbnQoKTtcbiAgfVxuXG4gIHN0YXJ0KCkge1xuICAgIHRoaXMuYWN0aXZlID0gdHJ1ZTtcbiAgICB0aGlzLmludGVydmFscy5wdXNoKDApO1xuICAgIHRoaXMuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgIH0sIDEwMDApO1xuICB9XG5cbiAgcGF1c2UoKSB7XG4gICAgaWYgKHRoaXMuYWN0aXZlKSB7XG4gICAgICBjbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWwpO1xuICAgICAgdGhpcy5hY3RpdmUgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICByZXNldCgpIHtcbiAgICB0aGlzLnBhdXNlKCk7XG4gICAgdGhpcy5pbnRlcnZhbHMubGVuZ3RoID0gMDtcbiAgICB0aGlzLnVwZGF0ZUVsZW1lbnQoKTtcbiAgfVxuXG4gIGdldFRpbWUoKSB7XG4gICAgY29uc3QgaG91cnMgPSBhcHBlbmRaZXJvKHRoaXMuZ2V0SG91cnMoKSk7XG4gICAgY29uc3QgbWludXRlcyA9IGFwcGVuZFplcm8odGhpcy5nZXRNaW51dGVzKCkpO1xuICAgIGNvbnN0IHNlY29uZHMgPSBhcHBlbmRaZXJvKHRoaXMuZ2V0U2Vjb25kcygpKTtcblxuICAgIGlmIChob3VycyA9PT0gJzAwJykge1xuICAgICAgcmV0dXJuIGAke21pbnV0ZXN9OiR7c2Vjb25kc31gO1xuICAgIH1cblxuICAgIHJldHVybiBgJHtob3Vyc306JHttaW51dGVzfToke3NlY29uZHN9YDtcbiAgfVxuXG4gIGdldE1pbGxpc2Vjb25kcygpIHtcbiAgICBjb25zdCB0aW1lUGFzc2VkID0gdGhpcy5pbnRlcnZhbHMucmVkdWNlKChhY2MsIGN1cnIpID0+IChhY2MgKyBjdXJyKSwgMCk7XG4gICAgY29uc3QgbWlsbGlzZWNvbmRzID0gdGltZVBhc3NlZCAlIDEwMDA7XG4gICAgcmV0dXJuIG1pbGxpc2Vjb25kcztcbiAgfVxuXG4gIGdldFNlY29uZHMoKSB7XG4gICAgY29uc3QgdGltZVBhc3NlZCA9IHRoaXMuaW50ZXJ2YWxzLnJlZHVjZSgoYWNjLCBjdXJyKSA9PiAoYWNjICsgY3VyciksIDApO1xuICAgIGNvbnN0IHNlY29uZHMgPSBNYXRoLmZsb29yKCh0aW1lUGFzc2VkICUgNjAwMDApIC8gMTAwMCk7XG4gICAgcmV0dXJuIHNlY29uZHM7XG4gIH1cblxuICBnZXRNaW51dGVzKCkge1xuICAgIGNvbnN0IHRpbWVQYXNzZWQgPSB0aGlzLmludGVydmFscy5yZWR1Y2UoKGFjYywgY3VycikgPT4gKGFjYyArIGN1cnIpLCAwKTtcbiAgICBjb25zdCBtaW51dGVzID0gTWF0aC5mbG9vcigodGltZVBhc3NlZCAlICg2MCAqIDYwMDAwKSkgLyA2MDAwMCk7XG4gICAgcmV0dXJuIG1pbnV0ZXM7XG4gIH1cblxuICBnZXRIb3VycygpIHtcbiAgICBjb25zdCB0aW1lUGFzc2VkID0gdGhpcy5pbnRlcnZhbHMucmVkdWNlKChhY2MsIGN1cnIpID0+IChhY2MgKyBjdXJyKSwgMCk7XG4gICAgY29uc3QgaG91cnMgPSBNYXRoLmZsb29yKHRpbWVQYXNzZWQgLyAoNjAgKiA2MDAwMCkpO1xuICAgIHJldHVybiBob3VycztcbiAgfVxuXG4gIGNyZWF0ZUVsZW1lbnQodGFnKSB7XG4gICAgdGhpcy5ET01FbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWcpO1xuICAgIHRoaXMudXBkYXRlRWxlbWVudCgpO1xuICAgIHJldHVybiB0aGlzLkRPTUVsZW1lbnQ7XG4gIH1cblxuICB1cGRhdGVFbGVtZW50KCkge1xuICAgIGlmICh0aGlzLkRPTUVsZW1lbnQpIHtcbiAgICAgIHRoaXMuRE9NRWxlbWVudC50ZXh0Q29udGVudCA9IHRoaXMuZ2V0VGltZSgpO1xuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0ICcuL3N0eWxlLmNzcyc7XG5pbXBvcnQgR2VtUHV6emxlIGZyb20gJy4vZ2VtLXB1enpsZS9nZW0tcHV6emxlJztcblxuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3BhZ2UnKTtcbmRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCgncGFnZV9faW5uZXInKTtcblxuY29uc3QgZ2VtUHV6emxlID0gbmV3IEdlbVB1enpsZSgpO1xuY29uc3QgZ2VtUHV6emxlRWxlbWVudCA9IGdlbVB1enpsZS5pbml0KCk7XG5kb2N1bWVudC5ib2R5LmFwcGVuZChnZW1QdXp6bGVFbGVtZW50KTtcbiIsImltcG9ydCAnLi9zdHlsZS5jc3MnO1xuaW1wb3J0IFRpbWVyIGZyb20gJy4vVGltZXInO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHZW1QdXp6bGUge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnRpbWVyID0gbmV3IFRpbWVyKCk7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIHNpemU6IDQsXG4gICAgICB0aWxlczogW10sXG4gICAgICBtb3ZlczogMCxcbiAgICAgIGlzU29sdmVkOiBmYWxzZSxcbiAgICB9O1xuXG4gICAgdGhpcy5zdGF0ZVByb3h5ID0gbmV3IFByb3h5KHRoaXMuc3RhdGUsIHtcbiAgICAgIHNldDogKHRhcmdldCwgcHJvcCwgdmFsdWUsIHJlY2VpdmVyKSA9PiB7XG4gICAgICAgIGlmIChwcm9wID09PSAnbW92ZXMnKSB7XG4gICAgICAgICAgdGhpcy5lbGVtZW50cy5tb3ZlQ291bnRlci50ZXh0Q29udGVudCA9IGBNb3ZlczogJHt2YWx1ZX1gO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHByb3AgPT09ICdzaXplJykge1xuICAgICAgICAgIFJlZmxlY3Quc2V0KHRhcmdldCwgcHJvcCwgdmFsdWUsIHJlY2VpdmVyKTtcbiAgICAgICAgICB0aGlzLnN0YXJ0TmV3R2FtZSgpO1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFJlZmxlY3Quc2V0KHRhcmdldCwgcHJvcCwgdmFsdWUsIHJlY2VpdmVyKTtcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICB0aGlzLmV2ZW50TGlzdGVuZXJzID0ge1xuICAgICAgdGlsZU9uY2xpY2s6IChldmVudCkgPT4ge1xuICAgICAgICBjb25zdCB7IHRpbGVzLCBzaXplIH0gPSB0aGlzLnN0YXRlO1xuICAgICAgICBjb25zdCBpbmRleCA9IHRpbGVzLm1hcCgodGlsZSkgPT4gdGlsZS5lbGVtZW50KS5pbmRleE9mKGV2ZW50LnRhcmdldCk7XG5cbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuaXNTb2x2ZWQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXRoaXMudGltZXIuYWN0aXZlKSB7XG4gICAgICAgICAgdGhpcy50aW1lci5zdGFydCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgc3dpdGNoICh0cnVlKSB7XG4gICAgICAgICAgY2FzZSB0aWxlc1tpbmRleCAtIDFdICYmIHRpbGVzW2luZGV4IC0gMV0uaWQgPT09IC0xICYmIGluZGV4ICUgc2l6ZSAhPT0gMDpcbiAgICAgICAgICAgIFt0aWxlc1tpbmRleF0sIHRpbGVzW2luZGV4IC0gMV1dID0gW3RpbGVzW2luZGV4IC0gMV0sIHRpbGVzW2luZGV4XV07XG4gICAgICAgICAgICB0aGlzLnN0YXRlUHJveHkubW92ZXMgKz0gMTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgdGlsZXNbaW5kZXggKyAxXSAmJiB0aWxlc1tpbmRleCArIDFdLmlkID09PSAtMSAmJiBpbmRleCAlIHNpemUgIT09IHNpemUgLSAxOlxuICAgICAgICAgICAgW3RpbGVzW2luZGV4XSwgdGlsZXNbaW5kZXggKyAxXV0gPSBbdGlsZXNbaW5kZXggKyAxXSwgdGlsZXNbaW5kZXhdXTtcbiAgICAgICAgICAgIHRoaXMuc3RhdGVQcm94eS5tb3ZlcyArPSAxO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSB0aWxlc1tpbmRleCAtIHNpemVdICYmIHRpbGVzW2luZGV4IC0gc2l6ZV0uaWQgPT09IC0xOlxuICAgICAgICAgICAgW3RpbGVzW2luZGV4XSwgdGlsZXNbaW5kZXggLSBzaXplXV0gPSBbdGlsZXNbaW5kZXggLSBzaXplXSwgdGlsZXNbaW5kZXhdXTtcbiAgICAgICAgICAgIHRoaXMuc3RhdGVQcm94eS5tb3ZlcyArPSAxO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSB0aWxlc1tpbmRleCArIHNpemVdICYmIHRpbGVzW2luZGV4ICsgc2l6ZV0uaWQgPT09IC0xOlxuICAgICAgICAgICAgW3RpbGVzW2luZGV4XSwgdGlsZXNbaW5kZXggKyBzaXplXV0gPSBbdGlsZXNbaW5kZXggKyBzaXplXSwgdGlsZXNbaW5kZXhdXTtcbiAgICAgICAgICAgIHRoaXMuc3RhdGVQcm94eS5tb3ZlcyArPSAxO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVuZGVyVGlsZXMoKTtcbiAgICAgICAgdGhpcy5jaGVja1N0YXRlKCk7XG4gICAgICB9LFxuICAgIH07XG4gIH1cblxuICBpbml0KCkge1xuICAgIHRoaXMuY3JlYXRlRWxlbWVudHMoKTtcbiAgICB0aGlzLmdlbmVyYXRlVGlsZXMoKTtcbiAgICB0aGlzLnN0YXJ0TmV3R2FtZSgpO1xuICAgIHJldHVybiB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lcjtcbiAgfVxuXG4gIHN0YXJ0TmV3R2FtZSgpIHtcbiAgICB0aGlzLnN0YXRlLmlzU29sdmVkID0gZmFsc2U7XG4gICAgdGhpcy5zdGF0ZVByb3h5Lm1vdmVzID0gMDtcbiAgICB0aGlzLnRpbWVyLnJlc2V0KCk7XG4gICAgdGhpcy5zaHVmZmxlVGlsZXMoKTtcbiAgICB0aGlzLnJlbmRlclRpbGVzKCk7XG4gICAgdGhpcy5lbGVtZW50cy5ib2FyZC5zdHlsZS5ncmlkVGVtcGxhdGVDb2x1bW5zID0gYHJlcGVhdCgke3RoaXMuc3RhdGUuc2l6ZX0sIDFmcilgO1xuICB9XG5cbiAgZ2VuZXJhdGVUaWxlcygpIHtcbiAgICBjb25zdCB0aWxlQW1vdW50ID0gdGhpcy5zdGF0ZS5zaXplICoqIDI7XG4gICAgY29uc3QgdGlsZXMgPSBbXTtcbiAgICBjb25zdCBlbXB0eVRpbGUgPSB7XG4gICAgICBpZDogLTEsXG4gICAgICBlbGVtZW50OiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSxcbiAgICB9O1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aWxlQW1vdW50IC0gMTsgaSArPSAxKSB7XG4gICAgICBjb25zdCB0aWxlID0geyB9O1xuICAgICAgdGlsZS5pZCA9IGkgKyAxO1xuICAgICAgdGlsZS5lbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICB0aWxlLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZ2VtLXB1enpsZV9fdGlsZScpO1xuICAgICAgdGlsZS5lbGVtZW50LnRleHRDb250ZW50ID0gdGlsZS5pZDtcbiAgICAgIHRpbGVzLnB1c2godGlsZSk7XG5cbiAgICAgIHRpbGUuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuZXZlbnRMaXN0ZW5lcnMudGlsZU9uY2xpY2spO1xuICAgIH1cblxuICAgIHRpbGVzLnB1c2goZW1wdHlUaWxlKTtcbiAgICB0aGlzLnN0YXRlLnRpbGVzID0gdGlsZXM7XG4gIH1cblxuICByZW5kZXJUaWxlcygpIHtcbiAgICBjb25zdCB7IHRpbGVzIH0gPSB0aGlzLnN0YXRlO1xuICAgIHRpbGVzLmZvckVhY2goKHRpbGUpID0+IHtcbiAgICAgIHRoaXMuZWxlbWVudHMuYm9hcmQuYXBwZW5kKHRpbGUuZWxlbWVudCk7XG4gICAgfSk7XG4gIH1cblxuICAvLyBtb3ZlVGlsZSh0aWxlSW5kZXgxLCB0aWxlSW5kZXgyKSB7XG4gIC8vICAgY29uc3QgdGlsZXMgPSB0aGlzLnN0YXRlLnRpbGVzO1xuICAvLyAgIGNvbnN0IG5leHRTaWJsaW5nID0gdGlsZTIubmV4dFNpYmxpbmc7XG4gIC8vICAgY29uc3QgcHJldlNpYmxpbmcgPSB0aWxlMi5wcmV2aW91c1NpYmxpbmc7XG4gIC8vICAgY29uc3QgcGFyZW50ID0gdGlsZTIucGFyZW50RWxlbWVudDtcbiAgLy8gICB0aWxlMS5yZXBsYWNlV2l0aCh0aWxlMik7XG5cbiAgLy8gICBpZiAobmV4dFNpYmxpbmcpIHtcbiAgLy8gICAgIG5leHRTaWJsaW5nLmJlZm9yZSh0aWxlMSk7XG4gIC8vICAgfSBlbHNlIGlmIChwcmV2U2libGluZykge1xuICAvLyAgICAgcHJldlNpYmxpbmcuYWZ0ZXIodGlsZTEpO1xuICAvLyAgIH0gZWxzZSB7XG4gIC8vICAgICBwYXJlbnQuYXBwZW5kKHRpbGUxKTtcbiAgLy8gICB9XG5cbiAgLy8gICBbdGlsZXNbaV0sIHRpbGVzW2kgLSAxXV0gPSBbdGlsZXNbaSAtIDFdLCB0aWxlc1tpXV07XG4gIC8vIH1cblxuICBjaGVja1N0YXRlKCkge1xuICAgIGNvbnN0IHRpbGVJZHMgPSB0aGlzLnN0YXRlLnRpbGVzLm1hcCgodGlsZSkgPT4gdGlsZS5pZCk7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSArIDIgPCB0aWxlSWRzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICBpZiAodGlsZUlkc1tpICsgMV0gIT09IHRpbGVJZHNbaV0gKyAxKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLnRpbWVyLnBhdXNlKCk7XG4gICAgdGhpcy5zdGF0ZS5pc1NvbHZlZCA9IHRydWU7XG5cbiAgICAvLyBzZXRUaW1lb3V0IHRvIGZpcmUgYWxlcnQgb25jZSB0aGUgZXZlbnQgbG9vcCBpcyBlbXB0eVxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgYWxlcnQoYFlvdSBzb2x2ZWQgdGhlIHB1enpsZSBpbiAke3RoaXMudGltZXIuZ2V0VGltZSgpfSBhbmQgbWFkZSAke3RoaXMuc3RhdGUubW92ZXN9IG1vdmVzLlxcblNvcnJ5IGZvciB0aGUgYWxlcnQsIHdvcmsgaW4gcHJvZ3Jlc3MuYCk7XG4gICAgfSwgMCk7XG4gIH1cblxuICBzaHVmZmxlVGlsZXMoKSB7XG4gICAgY29uc3QgdGlsZUFtb3VudCA9IHRoaXMuc3RhdGUuc2l6ZSAqKiAyO1xuICAgIGNvbnN0IHsgdGlsZXMgfSA9IHRoaXMuc3RhdGU7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRpbGVBbW91bnQ7IGkgKz0gMSkge1xuICAgICAgY29uc3QgcmFuZG9tVGlsZSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRpbGVBbW91bnQpO1xuICAgICAgW3RpbGVzW2ldLCB0aWxlc1tyYW5kb21UaWxlXV0gPSBbdGlsZXNbcmFuZG9tVGlsZV0sIHRpbGVzW2ldXTtcbiAgICB9XG5cbiAgICAvLyBTaHVmZmxlIHVudGlsIHNvbHZhYmxlIGNvbWJpbmF0aW9uIGlzIGZvdW5kXG4gICAgaWYgKCF0aGlzLmlzU29sdmFibGUoKSkgdGhpcy5zaHVmZmxlVGlsZXMoKTtcbiAgfVxuXG4gIGlzU29sdmFibGUoKSB7XG4gICAgY29uc3QgeyB0aWxlcywgc2l6ZSB9ID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCB0aWxlSWRzID0gdGlsZXMubWFwKCh0aWxlKSA9PiB0aWxlLmlkKTtcbiAgICBjb25zdCBlbXB0eVRpbGVJbmRleCA9IHRpbGVJZHMuaW5kZXhPZigtMSk7XG4gICAgY29uc3QgZW1wdHlUaWxlUm93ID0gTWF0aC5jZWlsKChlbXB0eVRpbGVJbmRleCArIDEpIC8gc2l6ZSk7XG4gICAgbGV0IGludmVyc2lvbnMgPSAwO1xuXG4gICAgLy8gQ291bnQgaW52ZXJzaW9uc1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGlsZUlkcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgaWYgKHRpbGVJZHNbaV0gIT09IC0xKSB7XG4gICAgICAgIGZvciAobGV0IGogPSBpOyBqIDwgdGlsZUlkcy5sZW5ndGg7IGogKz0gMSkge1xuICAgICAgICAgIGlmICh0aWxlSWRzW2ldID4gdGlsZUlkc1tqXSAmJiB0aWxlSWRzW2pdICE9PSAtMSkge1xuICAgICAgICAgICAgaW52ZXJzaW9ucyArPSAxO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIElmIE4gaXMgb2RkLCB0aGVuIHB1enpsZSBpbnN0YW5jZSBpcyBzb2x2YWJsZSBpZiBudW1iZXIgb2YgaW52ZXJzaW9ucyBpcyBldmVuLlxuICAgIGlmIChzaXplICUgMiA9PT0gMSAmJiBpbnZlcnNpb25zICUgMiA9PT0gMCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgaWYgKHNpemUgJSAyID09PSAwKSB7XG4gICAgICBpZiAoZW1wdHlUaWxlUm93ICUgMiA9PT0gMSAmJiBpbnZlcnNpb25zICUgMiA9PT0gMSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGlmIChlbXB0eVRpbGVSb3cgJSAyID09PSAwICYmIGludmVyc2lvbnMgJSAyID09PSAwKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGNyZWF0ZUVsZW1lbnRzKCkge1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGNvbnN0IHN0YXR1c0JhciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGNvbnN0IGJvYXJkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgY29uc3QgdGltZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgY29uc3QgbW92ZUNvdW50ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgY29uc3QgbmV3R2FtZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuXG4gICAgLy8gTWFpbiBlbGVtZW50cyBzZXR1cFxuICAgIGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdnZW0tcHV6emxlJyk7XG4gICAgc3RhdHVzQmFyLmNsYXNzTGlzdC5hZGQoJ2dlbS1wdXp6bGVfX3N0YXR1cy1iYXInKTtcbiAgICBib2FyZC5jbGFzc0xpc3QuYWRkKCdnZW0tcHV6emxlX19ib2FyZCcpO1xuICAgIGJvYXJkLnN0eWxlLmdyaWRUZW1wbGF0ZUNvbHVtbnMgPSBgcmVwZWF0KCR7dGhpcy5zdGF0ZS5zaXplfSwgMWZyKWA7XG5cbiAgICAvLyBUaW1lciBzZXR1cFxuICAgIHRpbWVyLnRleHRDb250ZW50ID0gJ1RpbWVyOiAnO1xuICAgIHRpbWVyLmFwcGVuZCh0aGlzLnRpbWVyLmNyZWF0ZUVsZW1lbnQoJ3RpbWUnKSk7XG5cbiAgICAvLyBNb3ZlIGNvdW50ZXIgc2V0dXBcbiAgICBtb3ZlQ291bnRlci50ZXh0Q29udGVudCA9ICdNb3ZlczogMCc7XG5cbiAgICAvLyBOZXcgZ2FtZSBidXR0b24gc2V0dXBcbiAgICBuZXdHYW1lQnRuLnR5cGUgPSAnYnV0dG9uJztcbiAgICBuZXdHYW1lQnRuLmNsYXNzTGlzdC5hZGQoJ2dlbS1wdXp6bGVfX2J1dHRvbicpO1xuICAgIG5ld0dhbWVCdG4udGV4dENvbnRlbnQgPSAnTmV3IGdhbWUnO1xuICAgIG5ld0dhbWVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLnN0YXJ0TmV3R2FtZSgpO1xuICAgIH0pO1xuXG4gICAgc3RhdHVzQmFyLmFwcGVuZCh0aW1lciwgbmV3R2FtZUJ0biwgbW92ZUNvdW50ZXIpO1xuICAgIGNvbnRhaW5lci5hcHBlbmQoc3RhdHVzQmFyLCBib2FyZCk7XG5cbiAgICB0aGlzLmVsZW1lbnRzID0ge1xuICAgICAgY29udGFpbmVyLFxuICAgICAgc3RhdHVzQmFyLFxuICAgICAgYm9hcmQsXG4gICAgICB0aW1lcixcbiAgICAgIG1vdmVDb3VudGVyLFxuICAgIH07XG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=